<!DOCTYPE html>
<html>

<head>
    <title>kellyjandrews</title>
    <link rel='stylesheet' href='/assets/css/styles.css' type='text/css' media='all' />
    <script src="/assets/js/bundle.js"></script>
    <link rel="alternate" type="application/rss+xml" title="kellyjandrews" href="/rss/">
    <link rel="canonical" href="http://kellyjandrews.com/" />
</head>


<body>
  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="row">
    <div class="col-md-6">
      <header class="site-header">
        <h1>
            <a href="/" title="kellyjandrews">kelly j andrews</a>
        </h1>
    </header>
</div>
    <div class="col-md-6 text-right">
      <a href="/experience" class="navlink"><i class="fa fa-info-circle fa-2x"></i></a>
      <a href="https://github.com/kellyjandrews" target="_blank"><i class="fa fa-github fa-2x"></i></a>
      <a href="https://twitter.com/kellyjandrews" target="_blank" ><i class="fa fa-twitter fa-2x"></i></a>
      <a href="https://www.linkedin.com/in/kjandrews/en" target="_blank" ><i class="fa fa-linkedin fa-2x"></i></a>
      <a href="https://stackexchange.com/users/2222625/kelly-j-andrews" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
  </div>
  </div>
  </div>
</nav>


    <div class="container-fluid">
        <div class="padded">
	<div class="col-md-8 col-md-offset-2">
  <h1>API Testing with SOAP UI</h1>
<p>Quite often at exacttarget, I find myself required to do some API work.  I’ll be the first to admit that staring at a SOAP enevelope for longer than a few seconds turns my brain to mush.</p>

<p>What I keep forgetting about, however, is there is a tool that helps you debug the simple stuff, and test out functionality you are trying to get a handle on.  This, couple with PHP logging,  now I can figure out exactly why my scripts aren’t working.  Let’s take a look.</p>

<h4 id="setup">Setup</h4>

<p>The very first thing you need to do, is download the application. You can find it at their <a href="http://www.soapui.org/">website</a>.  Download for your specific platform, and then run the installer (on my mac, I had to right-click open the installer).  You can use mostly the defaults, and you really only need the SOAP UI tool, so be sure to uncheck other items unless you need them for something else.</p>

<p>Once you have SOAP UI installed, you are good to get going. Go ahead and create a generic project (ctrl-alt-cmd-N for mac). Name your project “exacttarget” and the add the wsdl url <code class="highlighter-rouge">https://webservice.exacttarget.com/etframework.wsdl</code>. I typically will uncheck the box to create sample calls.  Click ok.</p>

<p>You should see all of the methods available to the SOAP API for exacttarget.</p>

<h4 id="getting-authorized">Getting Authorized</h4>
<p>SOAP UI also us to create REST services in our UI as well.  It’s really simple to do, and there is one specifically that we require.  First, you will need to have already set up an app in the exacttarget app center.  You can find app center currently at <a href="https://code.exacttarget.com">Code@</a>.  You will need to sign up for an account, then go through the process of connecting your exacttarget account, and selecting permissions (for now select as many as you can). What you want from this process is the <code class="highlighter-rouge">clientId</code> and <code class="highlighter-rouge">clientSecret</code>.</p>

<p>Once you have that completed, right click on the project name, and select “New REST Service from URI”.  In the dialog, copy and paste the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>https://auth.exacttargetapis.com/v1/requestToken
</code></pre>
</div>

<p>Click ok, and it will set everything up for you, and open a new window. Change the method type to <code class="highlighter-rouge">POST</code> and make sure the “Media Type” is listed as <code class="highlighter-rouge">application/json</code>. In the media type window, at the bottom, add this json, replacing the x’s with your appropriate information.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
  <span class="s2">"clientId"</span><span class="err">:</span> <span class="s2">"xxxxxxxxxx"</span><span class="p">,</span>
  <span class="s2">"clientSecret"</span><span class="err">:</span> <span class="s2">"xxxxxxxxxx"</span>
<span class="p">}</span>
</code></pre>
</div>

<p>After you get that set up, click the play button in the upper left portion of the window, and get your access token.  The token expires after 60 minutes, but you can come back here to update your token.</p>

<h4 id="building-your-soap">Building your SOAP</h4>

<p>If you haven’t build a SOAP enevelope before, it can be a little tricky at first, but it’s just XML, and looks a little like HTML, so you can easily learn the structure with a little help.</p>

<p>The first portion is building the envelope itself.  Let’s work with a <code class="highlighter-rouge">describe</code> method first. Right-click <code class="highlighter-rouge">describe</code> and select “New Request.” It will generate some generic code, you can delete all of that and replace with the following.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;soapenv:Envelope</span>
<span class="na">xmlns:soapenv=</span><span class="s">"http://schemas.xmlsoap.org/soap/envelope/"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>

   ...

<span class="nt">&lt;/soapenv:Envelope&gt;</span>
</code></pre>
</div>

<p>Running this code will give you a <code class="highlighter-rouge">Bad Request</code> response. That is expected, since we have a lot more code to add first.  it’s important to note the <code class="highlighter-rouge">soapenv</code> prefix is there to prevent any naming conflicts. This is an XML thing, and it references the information in <code class="highlighter-rouge">http://schemas.xmlsoap.org/soap/envelope</code>.  You would set up namespaces to avoid naming collisions, and provide syntax reference. The namespace declaration has the following syntax. <em>xmlns:prefix=”URI”</em>. It’s not required specifically, but makes things a little easier to look at.</p>

<h4 id="adding-the-header">Adding the header</h4>

<p>Now is when that authorization token is needed. If it’s been longer than 60 minutes, go ahead and refresh your token, copy and paste in your SOAP enevelope.  The header goes in between the open and closing <code class="highlighter-rouge">Envelope</code> tag.</p>

<div class="highlighter-rouge"><pre class="highlight"><code> <span class="nt">&lt;soapenv:Envelope</span> <span class="err">...</span><span class="nt">&gt;</span>
    <span class="nt">&lt;soapenv:Header&gt;</span>
         <span class="nt">&lt;ns1:fueloauth</span> <span class="na">xmlns:ns1=</span><span class="s">"http://exacttarget.com"</span><span class="nt">&gt;</span>XXXXXXXXXXXXXXXXXXXXXXXX<span class="nt">&lt;/ns1:fueloauth&gt;</span>
    <span class="nt">&lt;/soapenv:Header&gt;</span>
 <span class="nt">&lt;/soapenv:Envelope&gt;</span>
</code></pre>
</div>

<h4 id="give-the-head-a-body">Give the head a body</h4>

<p>The body is where the main work for the call is being done. Here you describe in XML everything you are doing.  For our example, let’s look at the <code class="highlighter-rouge">describe</code> on the <code class="highlighter-rouge">subscriber</code> object.</p>

<div class="highlighter-rouge"><pre class="highlight"><code> <span class="nt">&lt;soapenv:Envelope</span> <span class="err">...</span><span class="nt">&gt;</span>
    <span class="nt">&lt;soapenv:Header&gt;</span>...<span class="nt">&lt;/soapenv:Header&gt;</span>
    <span class="nt">&lt;soapenv:Body&gt;</span>
      <span class="nt">&lt;DefinitionRequestMsg</span> <span class="na">xmlns=</span><span class="s">"http://exacttarget.com/wsdl/partnerAPI"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;DescribeRequests&gt;</span>
            <span class="nt">&lt;ObjectDefinitionRequest&gt;</span>
                 <span class="nt">&lt;ObjectType&gt;</span>Subscriber<span class="nt">&lt;/ObjectType&gt;</span>
            <span class="nt">&lt;/ObjectDefinitionRequest&gt;</span>
         <span class="nt">&lt;/DescribeRequests&gt;</span>
      <span class="nt">&lt;/DefinitionRequestMsg&gt;</span>
  <span class="nt">&lt;/soapenv:Body&gt;</span>
 <span class="nt">&lt;/soapenv:Envelope&gt;</span>
</code></pre>
</div>

<h4 id="check-the-pointer">Check the Pointer</h4>
<p>Exacttarget has a few endpoints for you to be concerned with.  When you login to your account , you should see an indication of s1, s4, or s6.  If you don’t see one, it’s safe to assume you are on s1.</p>

<p>Why is this important? You need to point your SOAP call to the correct stack, or it won’t work.  One of these endpoints are what you most likely should use:
<code class="highlighter-rouge">html
https://webservice.exacttarget.com/Service.asmx
https://webservice.s4.exacttarget.com/Service.asmx
https://webservice.s6.exacttarget.com/Service.asmx
</code></p>

<h4 id="just-push-play">Just push play</h4>
<p>Now that you have everything set up, hit the play button in the top left corner of the request window.  On the right, you should now see the results that looks something like</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;soap:Envelope</span> <span class="na">xmlns:soap=</span><span class="s">"http://schemas.xmlsoap.org/soap/envelope/"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xmlns:wsa=</span><span class="s">"http://schemas.xmlsoap.org/ws/2004/08/addressing"</span> <span class="na">xmlns:wsse=</span><span class="s">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"</span> <span class="na">xmlns:wsu=</span><span class="s">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;soap:Header&gt;</span>
          <span class="nt">&lt;wsa:Action&gt;</span>DescribeResponse<span class="nt">&lt;/wsa:Action&gt;</span>
          <span class="nt">&lt;wsa:MessageID&gt;</span>urn:uuid:8e1453e9-089d-4e8e-a354-6762ea434213<span class="nt">&lt;/wsa:MessageID&gt;</span>
          <span class="nt">&lt;wsa:RelatesTo&gt;</span>urn:uuid:ce4235b3-5461-46c8-a58e-8cd40b1f8e5e<span class="nt">&lt;/wsa:RelatesTo&gt;</span>
      <span class="nt">&lt;wsa:To&gt;</span>http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous<span class="nt">&lt;/wsa:To&gt;</span>
          <span class="nt">&lt;wsse:Security&gt;</span>
             <span class="nt">&lt;wsu:Timestamp</span> <span class="na">wsu:Id=</span><span class="s">"Timestamp-f1b2e2ce-9291-4fb8-8083-df0cf46136d3"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;wsu:Created&gt;</span>2014-01-23T14:17:19Z<span class="nt">&lt;/wsu:Created&gt;</span>
                <span class="nt">&lt;wsu:Expires&gt;</span>2014-01-23T14:22:19Z<span class="nt">&lt;/wsu:Expires&gt;</span>
             <span class="nt">&lt;/wsu:Timestamp&gt;</span>
           <span class="nt">&lt;/wsse:Security&gt;</span>
       <span class="nt">&lt;/soap:Header&gt;</span>
       <span class="nt">&lt;soap:Body&gt;</span>
          <span class="nt">&lt;DefinitionResponseMsg</span> <span class="na">xmlns=</span><span class="s">"http://exacttarget.com/wsdl/partnerAPI"</span><span class="nt">&gt;</span>
             <span class="nt">&lt;ObjectDefinition&gt;</span>
                <span class="nt">&lt;ObjectType&gt;</span>Subscriber<span class="nt">&lt;/ObjectType&gt;</span>
                 <span class="nt">&lt;Properties&gt;</span>
                   <span class="nt">&lt;PartnerKey</span> <span class="na">xsi:nil=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
                   <span class="nt">&lt;ObjectID</span> <span class="na">xsi:nil=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
                   <span class="nt">&lt;Name&gt;</span>ID<span class="nt">&lt;/Name&gt;</span>
                   <span class="nt">&lt;DataType&gt;</span>Int32<span class="nt">&lt;/DataType&gt;</span>
                   <span class="nt">&lt;IsUpdatable&gt;</span>true<span class="nt">&lt;/IsUpdatable&gt;</span>
                   <span class="nt">&lt;IsRetrievable&gt;</span>true<span class="nt">&lt;/IsRetrievable&gt;</span>
                   <span class="nt">&lt;IsRequired&gt;</span>true<span class="nt">&lt;/IsRequired&gt;</span>
                <span class="nt">&lt;/Properties&gt;</span>
                ....
</code></pre>
</div>

<h4 id="go-forth-and-test">Go forth and test</h4>
<p>Now that you have this under your belt, go out and test other objects and methods.  Understanding the SOAP envelopes your code will create really helps develope a solid understanding of how your application will be interacting with the Fuel Platorm and exacttarget.</p>





<div id="disqus_thread"></div>
   <script type="text/javascript">
       /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
       var disqus_shortname = 'kellyjandrews'; // required: replace example with your forum shortname
       var disqus_title = "API Testing with SOAP UI";
       /* * * DON'T EDIT BELOW THIS LINE * * */
       (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
       })();
   </script>
   <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

</div>

    </div>

    <footer class="text-center">
    <small>All content copyright <a href="/">kelly j andrews</a> &copy; 2016 &bull; All rights reserved.</small>
    </a>
</footer>

    <script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-47461674-1', 'kellyjandrews.com');
    ga('send', 'pageview');
</script>
</body>

</html>
